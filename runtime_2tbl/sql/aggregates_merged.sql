CREATE TABLE agg_0 AS (
SELECT onpromotion,SUM(1*1) AS agg_6,SUM(unit_sales*1*1) AS agg_7,SUM(unit_sales*unit_sales*1*1) AS agg_8
FROM Sales NATURAL JOIN Oil
GROUP BY onpromotion);

CREATE TABLE agg_1 AS (
SELECT store,SUM(1*1) AS agg_3,SUM(unit_sales*1*1) AS agg_4,SUM(unit_sales*unit_sales*1*1) AS agg_5
FROM Sales NATURAL JOIN Oil
GROUP BY store);

CREATE TABLE agg_2 AS (
SELECT SUM(1*1) AS agg_0,SUM(unit_sales*1*1) AS agg_1,SUM(unit_sales*unit_sales*1*1) AS agg_2,SUM(CASE WHEN oilprize <= 35.360000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_9,SUM(unit_sales*CASE WHEN oilprize <= 35.360000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_10,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 35.360000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_11,SUM(CASE WHEN oilprize > 35.360000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_12,SUM(unit_sales*CASE WHEN oilprize > 35.360000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_13,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 35.360000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_14,SUM(CASE WHEN oilprize <= 40.050000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_15,SUM(unit_sales*CASE WHEN oilprize <= 40.050000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_16,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 40.050000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_17,SUM(CASE WHEN oilprize > 40.050000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_18,SUM(unit_sales*CASE WHEN oilprize > 40.050000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_19,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 40.050000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_20,SUM(CASE WHEN oilprize <= 43.040000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_21,SUM(unit_sales*CASE WHEN oilprize <= 43.040000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_22,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 43.040000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_23,SUM(CASE WHEN oilprize > 43.040000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_24,SUM(unit_sales*CASE WHEN oilprize > 43.040000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_25,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 43.040000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_26,SUM(CASE WHEN oilprize <= 44.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_27,SUM(unit_sales*CASE WHEN oilprize <= 44.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_28,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 44.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_29,SUM(CASE WHEN oilprize > 44.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_30,SUM(unit_sales*CASE WHEN oilprize > 44.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_31,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 44.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_32,SUM(CASE WHEN oilprize <= 45.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_33,SUM(unit_sales*CASE WHEN oilprize <= 45.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_34,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 45.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_35,SUM(CASE WHEN oilprize > 45.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_36,SUM(unit_sales*CASE WHEN oilprize > 45.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_37,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 45.470000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_38,SUM(CASE WHEN oilprize <= 46.120000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_39,SUM(unit_sales*CASE WHEN oilprize <= 46.120000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_40,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 46.120000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_41,SUM(CASE WHEN oilprize > 46.120000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_42,SUM(unit_sales*CASE WHEN oilprize > 46.120000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_43,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 46.120000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_44,SUM(CASE WHEN oilprize <= 47.170000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_45,SUM(unit_sales*CASE WHEN oilprize <= 47.170000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_46,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 47.170000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_47,SUM(CASE WHEN oilprize > 47.170000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_48,SUM(unit_sales*CASE WHEN oilprize > 47.170000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_49,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 47.170000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_50,SUM(CASE WHEN oilprize <= 48.130000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_51,SUM(unit_sales*CASE WHEN oilprize <= 48.130000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_52,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 48.130000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_53,SUM(CASE WHEN oilprize > 48.130000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_54,SUM(unit_sales*CASE WHEN oilprize > 48.130000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_55,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 48.130000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_56,SUM(CASE WHEN oilprize <= 49.070000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_57,SUM(unit_sales*CASE WHEN oilprize <= 49.070000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_58,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 49.070000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_59,SUM(CASE WHEN oilprize > 49.070000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_60,SUM(unit_sales*CASE WHEN oilprize > 49.070000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_61,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 49.070000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_62,SUM(CASE WHEN oilprize <= 49.850000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_63,SUM(unit_sales*CASE WHEN oilprize <= 49.850000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_64,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 49.850000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_65,SUM(CASE WHEN oilprize > 49.850000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_66,SUM(unit_sales*CASE WHEN oilprize > 49.850000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_67,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 49.850000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_68,SUM(CASE WHEN oilprize <= 51.610000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_69,SUM(unit_sales*CASE WHEN oilprize <= 51.610000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_70,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 51.610000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_71,SUM(CASE WHEN oilprize > 51.610000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_72,SUM(unit_sales*CASE WHEN oilprize > 51.610000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_73,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 51.610000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_74,SUM(CASE WHEN oilprize <= 53.010000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_75,SUM(unit_sales*CASE WHEN oilprize <= 53.010000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_76,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 53.010000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_77,SUM(CASE WHEN oilprize > 53.010000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_78,SUM(unit_sales*CASE WHEN oilprize > 53.010000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_79,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 53.010000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_80,SUM(CASE WHEN oilprize <= 54.590000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_81,SUM(unit_sales*CASE WHEN oilprize <= 54.590000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_82,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 54.590000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_83,SUM(CASE WHEN oilprize > 54.590000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_84,SUM(unit_sales*CASE WHEN oilprize > 54.590000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_85,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 54.590000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_86,SUM(CASE WHEN oilprize <= 60.250000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_87,SUM(unit_sales*CASE WHEN oilprize <= 60.250000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_88,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 60.250000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_89,SUM(CASE WHEN oilprize > 60.250000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_90,SUM(unit_sales*CASE WHEN oilprize > 60.250000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_91,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 60.250000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_92,SUM(CASE WHEN oilprize <= 90.880000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_93,SUM(unit_sales*CASE WHEN oilprize <= 90.880000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_94,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 90.880000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_95,SUM(CASE WHEN oilprize > 90.880000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_96,SUM(unit_sales*CASE WHEN oilprize > 90.880000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_97,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 90.880000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_98,SUM(CASE WHEN oilprize <= 93.840000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_99,SUM(unit_sales*CASE WHEN oilprize <= 93.840000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_100,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 93.840000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_101,SUM(CASE WHEN oilprize > 93.840000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_102,SUM(unit_sales*CASE WHEN oilprize > 93.840000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_103,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 93.840000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_104,SUM(CASE WHEN oilprize <= 97.030000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_105,SUM(unit_sales*CASE WHEN oilprize <= 97.030000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_106,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 97.030000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_107,SUM(CASE WHEN oilprize > 97.030000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_108,SUM(unit_sales*CASE WHEN oilprize > 97.030000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_109,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 97.030000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_110,SUM(CASE WHEN oilprize <= 100.520000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_111,SUM(unit_sales*CASE WHEN oilprize <= 100.520000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_112,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 100.520000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_113,SUM(CASE WHEN oilprize > 100.520000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_114,SUM(unit_sales*CASE WHEN oilprize > 100.520000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_115,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 100.520000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_116,SUM(CASE WHEN oilprize <= 104.060000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_117,SUM(unit_sales*CASE WHEN oilprize <= 104.060000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_118,SUM(unit_sales*unit_sales*CASE WHEN oilprize <= 104.060000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_119,SUM(CASE WHEN oilprize > 104.060000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_120,SUM(unit_sales*CASE WHEN oilprize > 104.060000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_121,SUM(unit_sales*unit_sales*CASE WHEN oilprize > 104.060000 THEN 1.0 ELSE 0.0 END*1*1) AS agg_122
FROM Sales NATURAL JOIN Oil);

